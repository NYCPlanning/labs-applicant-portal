<h5>Add a tax lot by searching a BBL or an address</h5>

<p class="help-text">
  NYC Planning's <a href="https://lotselector.planning.nyc.gov/" target="_blank" rel="noopener noreferrer">Tax Lot Selector</a> is a helpful tool for identifying and selecting tax lot BBL numbers within a project area. If your project is very large, you can download the BBLs from the Tax Lot Selector app using the "Paperless Filing" option and upload that file to this form as an attachment.
</p>

<LabsSearch
  @searchPlaceholder='Look up BBL (ex 1001440001)'
  data-test-input="bbl-search"
  @onSelect={{fn this.selectSearchResult}} as |search|
>
  <small class="dark-gray">{{search.result.label}} <br> {{bbl-breakup search.result.bbl}}</small>
</LabsSearch>

{{#if @bbls}}
  <h5>Tax Lots Included in This Project</h5>
{{/if}}

{{#each @bbls as |bbl idx|}}
  <fieldset class="fieldset relative">
    <legend data-test-bbl-title="{{bbl.dcpBblnumber}}">
      <a
        href="https://zola.planning.nyc.gov/bbl/{{bbl.dcpBblnumber}}"
        target="_blank"
        rel="noopener noreferrer"
      >
        <strong>{{bbl.dcpBblnumber}}</strong>
      </a>
      {{#if bbl.temporaryAddressLabel}}
        ({{bbl.temporaryAddressLabel}})
      {{/if}}
    </legend>
    <fieldset>
      <legend data-test-development-site-question="{{bbl.dcpBblnumber}}-{{bbl.dcpDevelopmentsite}}">
        Is this BBL part of the development site?
      </legend>
      <Input
        @type="radio"
        name={{concat idx '-bbl-dev-site'}}
        id={{concat idx '-bbl-dev-site-yes'}}
        @value={{eq bbl.dcpDevelopmentsite true}}
        checked={{eq bbl.dcpDevelopmentsite true}}
        {{on "click" (fn this.updateAttr bbl "dcpDevelopmentsite" true)}}
        data-test-bbl-development-site-yes="{{bbl.dcpBblnumber}}"
      />
      <label for="{{concat idx '-bbl-dev-site-yes'}}">
        Yes
      </label>
      <Input
        @type="radio"
        name={{concat idx '-bbl-dev-site'}}
        id={{concat idx '-bbl-dev-site-no'}}
        @value={{eq bbl.dcpDevelopmentsite false}}
        checked={{eq bbl.dcpDevelopmentsite false}}
        {{on "click" (fn this.updateAttr bbl "dcpDevelopmentsite" false)}}
        data-test-bbl-development-site-no="{{bbl.dcpBblnumber}}"
      />
      <label for="{{concat idx '-bbl-dev-site-no'}}">
        No
      </label>
    </fieldset>
    <fieldset>
      <legend data-test-partial-lot-question="{{bbl.dcpBblnumber}}-{{bbl.dcpPartiallot}}">
        Is only a portion of this lot included in the project area?
      </legend>
      <Input
        type="radio"
        name="bbl-partial-lot-yes"
        id="bbl-partial-lot-yes"
        @value={{eq bbl.dcpPartiallot true}}
        checked={{eq bbl.dcpPartiallot true}}
        {{on "click" (fn this.updateAttr bbl "dcpPartiallot" true)}}
        data-test-bbl-partial-lot-yes="{{bbl.dcpBblnumber}}"
      />
      <label for="bbl-partial-lot-yes">
        Yes
      </label>
      <Input
        @type="radio"
        name="bbl-partial-lot-no"
        id="bbl-partial-lot-no"
        @value={{eq bbl.dcpPartiallot false}}
        checked={{eq bbl.dcpPartiallot false}}
        {{on "click" (fn this.updateAttr bbl "dcpPartiallot" false)}}
        data-test-bbl-partial-lot-no="{{bbl.dcpBblnumber}}"
      />
      <label for="bbl-partial-lot-no">
        No
      </label>
    </fieldset>

    <button
      type="button"
      class="delete-fieldset"
      {{on "click" (fn this.removeBbl bbl)}}
      data-test-button-remove-bbl="{{bbl.dcpBblnumber}}"
    >
      Delete BBL
      <FaIcon @icon="times" @prefix="fas" @fixedWidth={{true}} />
    </button>
  </fieldset>
{{/each}}
